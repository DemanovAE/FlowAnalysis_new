Int_t GetEtaDirection(StFemtoTrack *const &track){

  if(track -> eta() < 0.) return 0;
  if(track -> eta() > 0.) return 1;
  return -1;
}

Float_t GetMass(Int_t particle){
  if(particle==0){
    return pion_mass;
  }
  if(particle==1){
    return kaon_mass;
  }
  if(particle==2){
    return proton_mass;
  }
  return 100.;
}

Double_t GetRapidity(StFemtoTrack *const &track, Int_t particle){

  Double_t E = sqrt( pow( track->p(), 2) + pow( GetMass(particle) ,2) );
  return 0.5 * log( (E + track->pMom().Z() ) / ( E - track->pMom().Z() ) );
}

Double_t GetWeight(StFemtoTrack *const &track){
  
  Double_t w;
  if (track->pt() < 2.0){
    w = track->pt();
  }
  else{
    w = 2.0;
  }
  return w;
}

Double_t GetWeightEfficiencies(Double_t pt, Int_t cent, Int_t PID, Int_t charge){
  
  // PID: 0-pion; 1-kaon; 2-proton
  // charge: 0-pos; 1-neg
  // cent:
  // 8  0-5%
  // 7  5-10%
  // 6  10-20% 
  // 5  20-30% 
  // 4  30-40% 
  // 3  40-50% 
  // 2  50-60% 
  // 1  60-70% 
  // 0  70-80% 

  Double_t par_a[3][2][9]={{{0.807997,0.820585,0.833831,0.846830,0.856186,0.862891,0.867639,0.870866,0.872933},{0.811298,0.824235,0.837849,0.851207,0.860822,0.867713,0.872592,0.875908,0.878033}},
                           {{0.775698,0.786620,0.798114,0.809393,0.817511,0.823329,0.827449,0.830249,0.832042},{0.775518,0.785682,0.796377,0.806873,0.814428,0.819841,0.823675,0.826280,0.827950}},
                           {{0.819507,0.832304,0.845770,0.858984,0.868495,0.875311,0.880138,0.883417,0.885519},{0.808067,0.820845,0.834291,0.847486,0.856984,0.863790,0.868609,0.871885,0.873983}}};

  Double_t par_b[3][2][9]={{{0.150417,0.149173,0.147864,0.146579,0.145654,0.144991,0.144521,0.144202,0.143998},{0.150061,0.148573,0.147007,0.145470,0.144364,0.143571,0.143010,0.142628,0.142384}},
                           {{0.286947,0.282422,0.277660,0.272988,0.269625,0.267215,0.265508,0.264348,0.263605},{0.284791,0.281112,0.277241,0.273443,0.270708,0.268749,0.267362,0.266419,0.265815}},
                           {{0.283735,0.281274,0.278683,0.276141,0.274312,0.273000,0.272072,0.271441,0.271037},{0.286692,0.284016,0.281199,0.278436,0.276447,0.275021,0.274012,0.273326,0.272886}}};

  Double_t par_c[3][2][9]={{{4.491428,4.569573,4.651809,4.732505,4.790589,4.832214,4.861688,4.881720,4.894553},{4.437529,4.718140,5.013438,5.303200,5.511774,5.661244,5.767078,5.839008,5.885091}},
                           {{1.792411,1.803554,1.815280,1.826787,1.835070,1.841005,1.845208,1.848064,1.849894},{1.734133,1.759871,1.786957,1.813534,1.832666,1.846375,1.856083,1.862681,1.866907}},
                           {{5.191236,5.318853,5.453152,5.584933,5.679790,5.747769,5.795901,5.828614,5.849573},{4.580009,4.666426,4.757366,4.846602,4.910834,4.956866,4.989458,5.011610,5.025801}}};

  Double_t w = par_a[PID][charge][8-cent]*TMath::Power(2.71828182, -1.*TMath::Power(par_b[PID][charge][8-cent]/pt,par_c[PID][charge][8-cent]));
  //Double_t w = 0.817511*pow(2.71828182, -1.*TMath::Power(0.269625/x,1.835070));
  //Double_t w = 0.856186*pow(2.71828182, -1.*TMath::Power(0.145654/x,4.790589));
  //Double_t w = 0.868495*pow(2.71828182, -1.*TMath::Power(0.274312/x,5.679790));
  return 1.0 / w;
  

/*
//Bin Cen.   a        b        c       a          b       c
//pion
8 0-5%   0.807997 0.150417 4.491428 0.811298 0.150061 4.437529
7 5-10%  0.820585 0.149173 4.569573 0.824235 0.148573 4.718140
6 10-20% 0.833831 0.147864 4.651809 0.837849 0.147007 5.013438
5 20-30% 0.846830 0.146579 4.732505 0.851207 0.145470 5.303200
4 30-40% 0.856186 0.145654 4.790589 0.860822 0.144364 5.511774
3 40-50% 0.862891 0.144991 4.832214 0.867713 0.143571 5.661244
2 50-60% 0.867639 0.144521 4.861688 0.872592 0.143010 5.767078
1 60-70% 0.870866 0.144202 4.881720 0.875908 0.142628 5.839008
0 70-80% 0.872933 0.143998 4.894553 0.878033 0.142384 5.885091

//kaon
8 0-5%   0.775698 0.286947 1.792411 0.775518 0.284791 1.734133
7 5-10%  0.786620 0.282422 1.803554 0.785682 0.281112 1.759871
6 10-20% 0.798114 0.277660 1.815280 0.796377 0.277241 1.786957
5 20-30% 0.809393 0.272988 1.826787 0.806873 0.273443 1.813534
4 30-40% 0.817511 0.269625 1.835070 0.814428 0.270708 1.832666
3 40-50% 0.823329 0.267215 1.841005 0.819841 0.268749 1.846375
2 50-60% 0.827449 0.265508 1.845208 0.823675 0.267362 1.856083
1 60-70% 0.830249 0.264348 1.848064 0.826280 0.266419 1.862681
0 70-80% 0.832042 0.263605 1.849894 0.827950 0.265815 1.866907

//proton
8 0-5%   0.819507 0.283735 5.191236 0.808067 0.286692 4.580009
7 5-10%  0.832304 0.281274 5.318853 0.820845 0.284016 4.666426
6 10-20% 0.845770 0.278683 5.453152 0.834291 0.281199 4.757366
5 20-30% 0.858984 0.276141 5.584933 0.847486 0.278436 4.846602
4 30-40% 0.868495 0.274312 5.679790 0.856984 0.276447 4.910834
3 40-50% 0.875311 0.273000 5.747769 0.863790 0.275021 4.956866
2 50-60% 0.880138 0.272072 5.795901 0.868609 0.274012 4.989458
1 60-70% 0.883417 0.271441 5.828614 0.871885 0.273326 5.011610
0 70-80% 0.885519 0.271037 5.849573 0.873983 0.272886 5.025801
*/

}


int GetCharge(StFemtoTrack *const &track){

  if((Int_t)track -> charge() > 0) return 0;
  if((Int_t)track -> charge() < 0) return 1;

  return -1;
}

Int_t GetBinPtRange(StFemtoTrack *const &track){

  if ( track->isTofTrack() ){
    for(Int_t i = 0; i < (int)ptBinRange.size()-1; i++){
      if( track->pt() >= ptBinRange[i] && track->pt() < ptBinRange[i+1]){
        return i;
      }
    }
  }
  return -1;
}

Int_t GetBinPt100(StFemtoTrack *const &track){

  if ( track->isTofTrack() ){
    for(Int_t i = 0; i < 100; i++){
      if( track->pt() >= 0.15 + (5./100.)*i && track->pt() < 0.15 + (5./100.)*(i+1)){
        return i;
      }
    }
  }
  return -1;
}

Bool_t TofMatchedCut(StFemtoDst *const &dst, StFemtoEvent *const &event, Int_t cutTofMatched, const Int_t _energy){

    Int_t nTrack = dst->numberOfTracks();
    Int_t number_tof=0;

    for(Int_t iTrk=0; iTrk<nTrack; iTrk++) {
      StFemtoTrack *femtoTrack = dst->track(iTrk);
      if ( !femtoTrack ) continue;
      if ( femtoTrack->isTofTrack()){
        number_tof++;
        if(number_tof>cutTofMatched)number_tof=1000000;
      }
    }

    if(number_tof<cutTofMatched) return false;

    //Double_t x = event->refMult();
    //Double_t fTof = -5.97231 + 0.69156*x + 0.0011181*x*x - 2.2378e-06*x*x*x;

    //if(number_tof < (int)fTof ) return false;

    return true;

}